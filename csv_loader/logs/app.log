2025-12-04 09:07:24,921 [INFO] __main__ - Starting CSV loader application...
2025-12-04 09:36:43,406 [INFO] root - Logging initialized. Writing to stdout and logs/app.log
2025-12-04 09:36:43,407 [INFO] __main__ - CSV Loader starting...
2025-12-04 09:36:43,407 [INFO] __main__ - Users CSV: /app/data/users_big.csv
2025-12-04 09:36:43,408 [INFO] __main__ - Products CSV: /app/data/products_big.csv
2025-12-04 09:36:43,408 [INFO] __main__ - Orders CSV: /app/data/orders_big.csv
2025-12-04 09:36:43,438 [INFO] __main__ - Initializing database schema...
2025-12-04 09:36:43,438 [INFO] app.db - Creating database tables (if not exist)...
2025-12-04 09:36:43,474 [INFO] app.db - Tables created.
2025-12-04 09:36:43,474 [INFO] __main__ - Creating Spark session...
2025-12-04 09:41:31,956 [INFO] root - Logging initialized. Writing to stdout and logs/app.log
2025-12-04 09:41:31,957 [INFO] __main__ - CSV Loader starting...
2025-12-04 09:41:31,958 [INFO] __main__ - Users CSV: /app/data/users_big.csv
2025-12-04 09:41:31,958 [INFO] __main__ - Products CSV: /app/data/products_big.csv
2025-12-04 09:41:31,958 [INFO] __main__ - Orders CSV: /app/data/orders_big.csv
2025-12-04 09:41:31,982 [INFO] __main__ - Initializing database schema...
2025-12-04 09:41:31,982 [INFO] app.db - Creating database tables (if not exist)...
2025-12-04 09:41:32,005 [INFO] app.db - Tables created.
2025-12-04 09:41:32,006 [INFO] __main__ - Creating Spark session...
2025-12-04 09:47:40,470 [INFO] root - Logging initialized. Writing to stdout and logs/app.log
2025-12-04 09:47:40,470 [INFO] __main__ - CSV Loader starting...
2025-12-04 09:47:40,471 [INFO] __main__ - Users CSV: /app/data/users_big.csv
2025-12-04 09:47:40,472 [INFO] __main__ - Products CSV: /app/data/products_big.csv
2025-12-04 09:47:40,472 [INFO] __main__ - Orders CSV: /app/data/orders_big.csv
2025-12-04 09:47:40,508 [INFO] __main__ - Initializing database schema...
2025-12-04 09:47:40,509 [INFO] app.db - Creating database tables (if not exist)...
2025-12-04 09:47:40,539 [INFO] app.db - Tables created.
2025-12-04 09:47:40,539 [INFO] __main__ - Creating Spark session...
2025-12-04 09:59:14,103 [INFO] root - Logging initialized. Writing to stdout and logs/app.log
2025-12-04 09:59:14,104 [INFO] __main__ - CSV Loader starting...
2025-12-04 09:59:14,105 [INFO] __main__ - Users CSV: /app/data/users_big.csv
2025-12-04 09:59:14,105 [INFO] __main__ - Products CSV: /app/data/products_big.csv
2025-12-04 09:59:14,105 [INFO] __main__ - Orders CSV: /app/data/orders_big.csv
2025-12-04 09:59:14,106 [INFO] __main__ - Views SQL path: sql/views.sql
2025-12-04 09:59:14,106 [INFO] __main__ - Spark config: app_name=csv_loader, master=local[*]
2025-12-04 09:59:14,133 [INFO] __main__ - Initializing database schema...
2025-12-04 09:59:14,133 [INFO] app.db - Creating database tables (if not exist)...
2025-12-04 09:59:14,156 [INFO] app.db - Tables created.
2025-12-04 09:59:14,156 [INFO] __main__ - Creating Spark session...
2025-12-04 09:59:15,903 [INFO] app.spark_job - SparkSession created with app name 'csv_loader'.
2025-12-04 09:59:15,906 [INFO] __main__ - Reading CSVs with Spark...
2025-12-04 09:59:15,906 [INFO] app.spark_job - Reading users from /app/data/users_big.csv
2025-12-04 09:59:16,868 [INFO] app.spark_job - Reading products from /app/data/products_big.csv
2025-12-04 09:59:16,895 [INFO] app.spark_job - Reading orders from /app/data/orders_big.csv
2025-12-04 09:59:18,292 [INFO] app.spark_job - Raw counts: users=500, products=2000, orders=15000
2025-12-04 09:59:18,292 [INFO] __main__ - Validating users...
2025-12-04 09:59:18,914 [INFO] app.spark_job - Users validation: valid=500, invalid=0
2025-12-04 09:59:18,915 [INFO] __main__ - Validating products...
2025-12-04 09:59:19,102 [INFO] app.spark_job - Products validation: valid=2000, invalid=0
2025-12-04 09:59:19,102 [INFO] __main__ - Validating orders...
2025-12-04 09:59:20,028 [INFO] app.spark_job - Orders validation: valid=15000, invalid=0
2025-12-04 09:59:20,032 [INFO] __main__ - Loading validated data into PostgreSQL...
2025-12-04 09:59:20,032 [INFO] app.loader - Loading users into PostgreSQL...
2025-12-04 09:59:20,173 [ERROR] app.loader - Error inserting users batch.
Traceback (most recent call last):
  File "/app/app/loader.py", line 49, in load_users
    session.bulk_save_objects(objs)
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Engine' object has no attribute 'bulk_save_objects'
2025-12-04 09:59:20,175 [INFO] py4j.clientserver - Closing down clientserver connection
2025-12-04 10:14:39,668 [INFO] root - Logging initialized. Writing to stdout and logs/app.log
2025-12-04 10:14:39,670 [INFO] __main__ - Starting CSV loader application...
2025-12-04 10:14:39,670 [INFO] __main__ - Users CSV: /app/data/users_big.csv
2025-12-04 10:14:39,670 [INFO] __main__ - Products CSV: /app/data/products_big.csv
2025-12-04 10:14:39,670 [INFO] __main__ - Orders CSV: /app/data/orders_big.csv
2025-12-04 10:14:39,699 [INFO] app.db - Database engine created for postgresql+psycopg2://csv_user:csv_password@db:5432/csv_db
2025-12-04 10:14:39,700 [INFO] __main__ - Initializing database schema...
2025-12-04 10:14:39,700 [INFO] app.db - Creating database schema (if not exists)...
2025-12-04 10:14:39,728 [INFO] app.db - Database schema initialized.
2025-12-04 10:14:39,728 [INFO] __main__ - Creating Spark session...
2025-12-04 10:14:41,529 [INFO] app.spark_job - SparkSession created with app name 'csv_loader'.
2025-12-04 10:14:41,529 [INFO] __main__ - Reading CSVs with Spark...
2025-12-04 10:14:41,529 [INFO] app.spark_job - Reading users from /app/data/users_big.csv
2025-12-04 10:14:42,483 [INFO] app.spark_job - Reading products from /app/data/products_big.csv
2025-12-04 10:14:42,517 [INFO] app.spark_job - Reading orders from /app/data/orders_big.csv
2025-12-04 10:14:44,019 [INFO] app.spark_job - Raw counts: users=500, products=2000, orders=15000
2025-12-04 10:14:44,022 [INFO] __main__ - Validating users...
2025-12-04 10:14:44,690 [INFO] app.spark_job - Users validation: valid=500, invalid=0
2025-12-04 10:14:44,695 [INFO] __main__ - Validating products...
2025-12-04 10:14:44,905 [INFO] app.spark_job - Products validation: valid=2000, invalid=0
2025-12-04 10:14:44,908 [INFO] __main__ - Validating orders...
2025-12-04 10:14:45,687 [INFO] app.spark_job - Orders validation: valid=15000, invalid=0
2025-12-04 10:14:45,687 [INFO] __main__ - Loading validated data into PostgreSQL...
2025-12-04 10:14:45,688 [INFO] app.loader - Loading users into PostgreSQL...
2025-12-04 10:14:45,841 [INFO] app.loader - Inserted 500 users.
2025-12-04 10:14:45,842 [INFO] app.loader - Loading products into PostgreSQL...
2025-12-04 10:14:45,972 [INFO] app.loader - Inserted 2000 products.
2025-12-04 10:14:45,973 [INFO] app.loader - Loading orders into PostgreSQL...
2025-12-04 10:14:46,591 [INFO] app.loader - Inserted 15000 orders.
2025-12-04 10:14:46,600 [INFO] __main__ - Creating views from sql/views.sql
2025-12-04 10:14:46,601 [INFO] app.db - Creating views from sql/views.sql ...
2025-12-04 10:14:46,605 [INFO] app.db - Views created successfully.
2025-12-04 10:14:46,605 [INFO] __main__ - CSV loader completed successfully
2025-12-04 10:14:46,606 [INFO] py4j.clientserver - Closing down clientserver connection
